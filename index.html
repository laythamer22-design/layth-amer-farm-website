<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Royal Oasis | Ù…Ø²Ø±Ø¹Ø© Ø£Ø¨Ùˆ Ø³ÙŠÙ ÙˆØ£Ø¨Ùˆ Ù†Ù…Ø±</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;700;900&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        :root { --gold: #c5a059; --dark: #050505; }
        body { font-family: 'Tajawal', sans-serif; background: var(--dark); color: white; scroll-behavior: smooth; overflow-x: hidden; }
        
        /* Background Theme */
        .hero-bg {
            background: linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6)), url('https://images.unsplash.com/photo-1512917774080-9991f1c4c750?q=80&w=2000');
            background-size: cover; background-attachment: fixed; background-position: center;
        }

        .glass { background: rgba(255, 255, 255, 0.03); backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.1); }
        .gold-text { background: linear-gradient(135deg, #fceabb, #f8b500); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .admin-modal { display: none; position: fixed; inset: 0; z-index: 9999; background: #050505; overflow-y: auto; padding: 2rem; }
        
        /* Receipt Style */
        #receiptUI { background: white; color: black; padding: 2.5rem; width: 400px; border: 10px double var(--gold); border-radius: 4px; position: relative; }
        .sig-stamp { position: absolute; bottom: 30px; left: 30px; width: 100px; transform: rotate(-15deg); filter: grayscale(1); opacity: 0.7; }

        /* Chatbot UI */
        .chat-box { position: fixed; bottom: 20px; right: 20px; width: 300px; z-index: 50; display: none; }
        
        /* Interactive Map */
        .map-point { position: absolute; background: #c5a059; width: 12px; height: 12px; border-radius: 50%; box-shadow: 0 0 15px #c5a059; animation: pulse 2s infinite; }
        @keyframes pulse { 0% { transform: scale(1); opacity: 1; } 100% { transform: scale(3); opacity: 0; } }
    </style>
</head>
<body class="hero-bg">

    <nav class="fixed top-0 w-full z-[100] glass border-b border-white/10 px-8 py-5 flex justify-between items-center">
        <div class="flex items-center gap-3">
            <div class="w-12 h-12 bg-gradient-to-br from-amber-400 to-amber-700 rounded-full flex items-center justify-center font-black text-black">AN</div>
            <h1 id="farmTitle" class="text-xl font-black gold-text italic tracking-tighter uppercase">Ø£Ø¨Ùˆ Ø³ÙŠÙ ÙˆØ£Ø¨Ùˆ Ù†Ù…Ø±</h1>
        </div>
        <div class="flex items-center gap-6 text-[10px] font-bold uppercase tracking-widest">
            <a href="#gallery" class="hover:text-amber-500">Ø§Ù„Ø£Ù„Ø¨ÙˆÙ…</a>
            <a href="#booking" class="hover:text-amber-500">Ø­Ø¬Ø²</a>
            <button onclick="openAdmin()" class="bg-amber-600/20 text-amber-500 px-4 py-2 rounded-full border border-amber-500/30">Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</button>
        </div>
    </nav>

    <section class="h-screen flex flex-col items-center justify-center text-center px-4">
        <h2 id="heroDisplay" class="text-6xl md:text-9xl font-black mb-4 gold-text">THE ROYAL OASIS</h2>
        <p class="text-lg md:text-2xl tracking-[10px] uppercase font-light">Experience Grandeur</p>
        <a href="#booking" class="mt-12 bg-white text-black px-12 py-4 rounded-full font-black text-xs hover:bg-amber-500 transition-all">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø­Ø¬Ø² Ø§Ù„Ø¢Ù†</a>
    </section>

    <section id="gallery" class="py-20 max-w-7xl mx-auto px-6 space-y-20">
        <div class="rounded-[4rem] overflow-hidden glass p-4 border border-amber-500/20 shadow-2xl">
            <video id="mainVideo" autoplay muted loop class="w-full h-[70vh] object-cover rounded-[3rem]">
                <source src="https://assets.mixkit.co/videos/preview/mixkit-luxury-villa-with-a-pool-at-sunset-2826-large.mp4" type="video/mp4">
            </video>
        </div>

        <div id="imageAlbum" class="grid grid-cols-1 md:grid-cols-4 gap-4">
            <img src="https://images.unsplash.com/photo-1613490493576-7fde63acd811?q=80&w=1000" class="rounded-3xl h-64 w-full object-cover">
            <img src="https://images.unsplash.com/photo-1582268611958-ebfd161ef9cf?q=80&w=1000" class="rounded-3xl h-64 w-full object-cover">
            <img src="https://images.unsplash.com/photo-1600607687920-4e2a09cf159d?q=80&w=1000" class="rounded-3xl h-64 w-full object-cover">
            <img src="https://images.unsplash.com/photo-1512917774080-9991f1c4c750?q=80&w=1000" class="rounded-3xl h-64 w-full object-cover">
        </div>
    </section>

    <section class="py-20 max-w-7xl mx-auto px-6">
        <div class="text-center mb-10">
            <h3 class="text-3xl font-black gold-text">ÙƒØªÙ„ÙˆÙƒ Ø§Ù„Ø®Ø§Ø±Ø·Ø© ÙˆØ§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ</h3>
            <p class="text-gray-500">ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…Ø±Ø§ÙÙ‚ ÙˆØ§Ù„Ø±ÙØ§Ù‡ÙŠØ©</p>
        </div>
        <div class="relative rounded-[3rem] overflow-hidden border border-white/10 glass h-[500px]">
            <img id="mapImg" src="https://images.unsplash.com/photo-1600607687920-4e2a09cf159d?q=80&w=2000" class="w-full h-full object-cover opacity-40">
            <div class="map-point top-1/4 left-1/3" title="Ø§Ù„Ù…Ø³Ø¨Ø­"></div>
            <div class="map-point top-1/2 right-1/4" title="ØµØ§Ù„Ø© Ø§Ù„Ù€ VIP"></div>
            <div class="map-point bottom-1/4 left-1/2" title="Ø§Ù„Ø­Ø¯Ø§Ø¦Ù‚ Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ©"></div>
        </div>
    </section>

    <section id="booking" class="py-32 max-w-5xl mx-auto px-6">
        <div class="glass p-12 rounded-[4rem] border-t-2 border-amber-500/50 shadow-2xl space-y-10">
            <div class="text-center">
                <h3 class="text-4xl font-black mb-2">ØªØ«Ø¨ÙŠØª Ø­Ø¬Ø² Ù…Ù„ÙƒÙŠ</h3>
                <p class="text-amber-500 font-bold">50% Ù…Ù‚Ø¯Ù… Ù„ØªØ«Ø¨ÙŠØª Ø§Ù„Ø­Ø¬Ø² - 50% Ø¹Ù†Ø¯ Ø§Ù„Ù…ØºØ§Ø¯Ø±Ø©</p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="space-y-4">
                    <input type="text" id="custName" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„" class="w-full bg-white/5 p-5 rounded-2xl border border-white/10 outline-none">
                    <select id="custType" class="w-full bg-slate-900 p-5 rounded-2xl border border-white/10">
                        <option>Ø¹Ø§Ø¦Ù„Ø© ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦</option>
                        <option>Ø´Ø¨Ø§Ø¨ ğŸ‘¨â€ğŸ‘¦â€ğŸ‘¦</option>
                    </select>
                    <select id="custDuration" class="w-full bg-slate-900 p-5 rounded-2xl border border-white/10" onchange="updatePriceDisplay()">
                        <option value="1">ÙŠÙˆÙ… ÙƒØ§Ù…Ù„ (24 Ø³Ø§Ø¹Ø©)</option>
                        <option value="0.5">Ù†ØµÙ ÙŠÙˆÙ… (12 Ø³Ø§Ø¹Ø©)</option>
                    </select>
                </div>

                <div class="grid grid-cols-2 gap-4 text-center">
                    <label id="labelId" class="border-2 border-dashed border-white/20 p-8 rounded-3xl cursor-pointer hover:border-amber-500 transition-all">
                        <i data-lucide="contact-2" class="mx-auto mb-2 opacity-50"></i>
                        <span class="text-[10px] block">Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù…ÙˆØ­Ø¯Ø©</span>
                        <input type="file" id="inputId" class="hidden" onchange="uploadDone('labelId')">
                    </label>
                    <label id="labelHome" class="border-2 border-dashed border-white/20 p-8 rounded-3xl cursor-pointer hover:border-amber-500 transition-all">
                        <i data-lucide="home" class="mx-auto mb-2 opacity-50"></i>
                        <span class="text-[10px] block">Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø³ÙƒÙ†</span>
                        <input type="file" id="inputHome" class="hidden" onchange="uploadDone('labelHome')">
                    </label>
                </div>
            </div>

            <div class="bg-amber-500/10 p-6 rounded-3xl border border-amber-500/20 flex justify-between items-center">
                <div>
                    <p class="text-xs text-gray-400">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: <span id="totalVal">150,000</span> Ø¯.Ø¹</p>
                    <p class="text-lg font-black text-amber-500">Ø§Ù„Ù…Ù‚Ø¯Ù… (50%): <span id="downVal">75,000</span> Ø¯.Ø¹</p>
                </div>
                <button onclick="requestWhatsApp()" class="bg-amber-600 px-10 py-4 rounded-2xl font-black text-black shadow-xl hover:scale-105 transition-all">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¬Ø² ÙˆØ§Ù„Ø¯ÙØ¹ ğŸ’³</button>
            </div>
        </div>
    </section>

    <div id="aiChat" class="chat-box glass p-4 rounded-3xl border border-amber-500/30 shadow-2xl">
        <div class="flex justify-between items-center mb-4 border-b border-white/10 pb-2">
            <span class="text-xs font-black gold-text">Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ù…Ø²Ø±Ø¹Ø© Ø§Ù„Ø°ÙƒÙŠ</span>
            <button onclick="toggleChat()" class="text-gray-400">Ã—</button>
        </div>
        <div id="chatContent" class="h-48 overflow-y-auto text-[10px] space-y-2 mb-4">
            <p class="bg-white/5 p-2 rounded-lg">Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ! Ø£Ù†Ø§ Ø§Ù„Ø¨ÙˆØª Ø§Ù„Ø®Ø§Øµ Ø¨Ù…Ø²Ø±Ø¹Ø© Ø£Ø¨Ùˆ Ø³ÙŠÙ ÙˆØ£Ø¨Ùˆ Ù†Ù…Ø±. ÙƒÙŠÙ Ø£Ø®Ø¯Ù…ÙƒØŸ</p>
        </div>
        <div class="flex gap-2">
            <input type="text" id="chatInput" placeholder="Ø§Ø³Ø£Ù„Ù†ÙŠ Ø£ÙŠ Ø´ÙŠØ¡..." class="flex-1 bg-black/40 border border-white/10 p-2 rounded-xl text-xs outline-none">
            <button onclick="aiResponse()" class="bg-amber-600 p-2 rounded-xl"><i data-lucide="send" class="w-4 h-4 text-black"></i></button>
        </div>
    </div>
    <button onclick="toggleChat()" class="fixed bottom-6 right-6 w-14 h-14 bg-amber-600 rounded-full flex items-center justify-center shadow-2xl z-50">
        <i data-lucide="bot" class="text-black"></i>
    </button>

    <div id="adminPanel" class="admin-modal">
        <div class="max-w-6xl mx-auto space-y-10 pb-20">
            <div class="flex justify-between items-center border-b border-white/10 pb-6">
                <h2 class="text-4xl font-black gold-text italic uppercase">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù„ÙƒÙŠØ© Ø§Ù„Ù…Ø·Ù„Ù‚Ø©</h2>
                <button onclick="document.getElementById('adminPanel').style.display='none'" class="bg-red-600/20 text-red-500 px-6 py-2 rounded-full font-bold">Ø¥ØºÙ„Ø§Ù‚</button>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                <div class="glass p-6 rounded-3xl">
                    <p class="text-xs text-gray-500">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª</p>
                    <h4 id="statCount" class="text-3xl font-black">0</h4>
                </div>
                <div class="glass p-6 rounded-3xl">
                    <p class="text-xs text-gray-500">Ø§Ù„Ø¯Ø®Ù„ Ø§Ù„ÙƒÙ„ÙŠ (Ø£Ø³Ø¨ÙˆØ¹ÙŠ/Ø´Ù‡Ø±ÙŠ)</p>
                    <h4 id="statIncome" class="text-3xl font-black text-green-500">0 Ø¯.Ø¹</h4>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <div class="glass p-8 rounded-[3rem] space-y-6">
                    <h4 class="font-black text-amber-500 uppercase tracking-widest">ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„ØªØ¹Ø¯ÙŠÙ„</h4>
                    <div class="space-y-4">
                        <input type="text" id="setFarmName" placeholder="ØªØºÙŠÙŠØ± Ø§Ø³Ù… Ø§Ù„Ù…Ø²Ø±Ø¹Ø©" class="w-full bg-white/5 p-4 rounded-xl border border-white/10">
                        <input type="number" id="setBasePrice" placeholder="ØªØºÙŠÙŠØ± Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ" class="w-full bg-white/5 p-4 rounded-xl border border-white/10">
                        <input type="text" id="setWANumber" placeholder="ØªØºÙŠÙŠØ± Ø±Ù‚Ù… ÙˆØ§ØªØ³Ø§Ø¨ Ø§Ù„Ù…Ø²Ø±Ø¹Ø©" class="w-full bg-white/5 p-4 rounded-xl border border-white/10">
                        <input type="password" id="setAdminPass" placeholder="ØªØºÙŠÙŠØ± Ø¨Ø§Ø³ÙˆÙˆØ±Ø¯ Ø§Ù„Ù…Ø¯ÙŠØ±" class="w-full bg-white/5 p-4 rounded-xl border border-white/10">
                        <textarea id="setBotInfo" placeholder="ØªØ¹Ø¯ÙŠÙ„ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¨ÙˆØª (Ù…Ø§Ø°Ø§ ÙŠØ¬ÙŠØ¨ØŸ)" class="w-full bg-white/5 p-4 rounded-xl border border-white/10 h-24"></textarea>
                        <div class="p-4 border-2 border-dashed border-amber-600/30 rounded-xl">
                            <p class="text-[10px] mb-2">ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ù…Ø¯ÙŠØ± (ØµÙˆØ±Ø© PNG)</p>
                            <input type="file" onchange="uploadSig(this)">
                        </div>
                    </div>
                    <button onclick="saveAdminSettings()" class="w-full bg-amber-600 py-4 rounded-2xl font-black text-black">Ø­ÙØ¸ ÙƒØ§ÙØ© Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª âœ…</button>
                </div>

                <div class="glass p-8 rounded-[3rem] space-y-6 overflow-hidden">
                    <h4 class="font-black text-blue-500 uppercase tracking-widest">Ø§Ù„Ø£Ø±Ø´ÙØ© ÙˆØ§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</h4>
                    <div class="overflow-x-auto">
                        <table class="w-full text-right text-xs">
                            <thead class="bg-white/5">
                                <tr>
                                    <th class="p-3">#</th>
                                    <th class="p-3">Ø§Ù„Ø²Ø¨ÙˆÙ†</th>
                                    <th class="p-3">Ø§Ù„Ø­Ø§Ù„Ø©</th>
                                    <th class="p-3">Ø¥Ø¬Ø±Ø§Ø¡</th>
                                </tr>
                            </thead>
                            <tbody id="dbTable"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="receiptModal" class="fixed inset-0 z-[10001] bg-black/95 hidden flex flex-col items-center justify-center p-6">
        <div id="receiptUI">
            <div class="text-center space-y-2 mb-6 border-b border-black pb-4">
                <h2 id="rFarmName" class="text-2xl font-black italic">Ù…Ø²Ø±Ø¹Ø© Ø£Ø¨Ùˆ Ø³ÙŠÙ ÙˆØ£Ø¨Ùˆ Ù†Ù…Ø±</h2>
                <p class="text-[9px] uppercase tracking-[5px]">ÙØ§ØªÙˆØ±Ø© Ø­Ø¬Ø² Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ© - OFFICIAL INVOICE</p>
            </div>
            <div class="space-y-3 text-[11px] font-mono">
                <div class="flex justify-between"><span>Ø±Ù‚Ù… Ø§Ù„ÙˆØµÙ„:</span> <span id="rID" class="font-bold">#0001</span></div>
                <div class="flex justify-between"><span>Ø§Ù„ØªØ§Ø±ÙŠØ®:</span> <span id="rDate">-</span></div>
                <div class="flex justify-between"><span>Ø§Ù„Ù…Ø³ØªØ£Ø¬Ø±:</span> <span id="rCust">-</span></div>
                <div class="flex justify-between font-bold border-t border-black pt-2"><span>Ø§Ù„Ù…Ù‚Ø¯Ù… (50%):</span> <span id="rPaid">-</span></div>
                <div class="flex justify-between text-gray-500"><span>Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ (Ø¹Ù†Ø¯ Ø§Ù„Ù…ØºØ§Ø¯Ø±Ø©):</span> <span id="rRem">-</span></div>
            </div>
            <div id="qrcode" class="flex justify-center my-6"></div>
            <img id="rSig" src="" class="sig-stamp">
            <p class="text-[8px] text-center border-t border-dotted border-black pt-4">Ø­Ø§Ù„Ø© Ø§Ù„Ø¯ÙØ¹: Ù…Ø¤ÙƒØ¯Ø© ÙˆÙ…Ø¤Ø±Ø´ÙØ© Ù…Ù† Ù‚Ø¨Ù„ Ø§Ù„Ù…Ø¯ÙŠØ± âœ…</p>
            <div class="mt-8 no-print flex gap-2">
                <button onclick="window.print()" class="flex-1 bg-black text-white py-2 rounded-lg text-xs">Ø·Ø¨Ø§Ø¹Ø© / PDF</button>
                <button onclick="location.reload()" class="flex-1 border border-black py-2 rounded-lg text-xs">Ø¥ØºÙ„Ø§Ù‚</button>
            </div>
        </div>
    </div>

    <script>
        lucide.createIcons();
        
        let db = JSON.parse(localStorage.getItem('farm_db')) || [];
        let config = JSON.parse(localStorage.getItem('farm_config')) || {
            name: "Ø£Ø¨Ùˆ Ø³ÙŠÙ ÙˆØ£Ø¨Ùˆ Ù†Ù…Ø±",
            price: 150000,
            wa: "9647700000000",
            pass: "1234",
            bot: "Ø§Ù„Ù…Ø²Ø±Ø¹Ø© ØªÙ‚Ø¹ ÙÙŠ Ø¨ØºØ¯Ø§Ø¯ØŒ ØªÙˆÙØ± Ù…Ø³Ø¨Ø­Ø§Ù‹ Ù…Ù„ÙƒÙŠØ§Ù‹ ÙˆØºØ±Ù VIP. Ø§Ù„Ø­Ø¬Ø² ÙŠØªØ·Ù„Ø¨ Ø¯ÙØ¹ 50% Ù…Ù‚Ø¯Ù…Ø§Ù‹.",
            sig: ""
        };

        // Initialize UI from config
        document.getElementById('farmTitle').innerText = config.name;
        document.getElementById('heroDisplay').innerText = config.name.toUpperCase();

        function uploadDone(id) {
            const el = document.getElementById(id);
            el.style.borderColor = "#10b981";
            el.style.background = "rgba(16, 185, 129, 0.1)";
            el.innerHTML = '<i data-lucide="check-circle" class="mx-auto text-green-500 mb-2"></i><span class="text-[10px] text-green-500">ØªÙ… Ø§Ù„Ø±ÙØ¹ Ø¨Ù†Ø¬Ø§Ø­</span>';
            lucide.createIcons();
        }

        function updatePriceDisplay() {
            const dur = document.getElementById('custDuration').value;
            const total = config.price * dur;
            document.getElementById('totalVal').innerText = total.toLocaleString();
            document.getElementById('downVal').innerText = (total * 0.5).toLocaleString();
        }

        function requestWhatsApp() {
            const name = document.getElementById('custName').value;
            const idFile = document.getElementById('inputId').files[0];
            if(!name || !idFile) return alert("ÙŠØ±Ø¬Ù‰ Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ±ÙØ¹ Ø§Ù„Ù…Ø³ØªÙ…Ø³ÙƒØ§Øª!");

            const newBooking = {
                id: db.length + 1,
                name: name,
                date: new Date().toLocaleDateString('ar-EG'),
                status: 'Ø¨Ø§Ù†ØªØ¸Ø§Ø± ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ù…Ø¯ÙŠØ±',
                total: config.price * document.getElementById('custDuration').value,
                paid: false
            };
            db.push(newBooking);
            localStorage.setItem('farm_db', JSON.stringify(db));

            const msg = `Ø·Ù„Ø¨ Ø­Ø¬Ø² Ø¬Ø¯ÙŠØ¯ Ù…Ù†: ${name}\nØ§Ù„Ù†ÙˆØ¹: ${document.getElementById('custType').value}\nØ§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø·Ù„ÙˆØ¨: ${newBooking.total * 0.5} Ø¯.Ø¹\n(ÙŠØ±Ø¬Ù‰ ØªØ£ÙƒÙŠØ¯ Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„Ù…Ø¨Ù„Øº ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„ÙˆØµÙ„)`;
            window.open(`https://wa.me/${config.wa}?text=${encodeURIComponent(msg)}`);
            alert("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨Ùƒ. Ø§Ù„ÙˆØµÙ„ Ø³ÙŠØµØ¯Ø± ÙÙˆØ± ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ù…Ø¯ÙŠØ± Ù„Ù„Ø¯ÙØ¹.");
        }

        function openAdmin() {
            if(prompt("Ø±Ù…Ø² Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø¯ÙŠØ±:") === config.pass) {
                renderAdmin();
                document.getElementById('adminPanel').style.display = 'block';
            }
        }

        function uploadSig(input) {
            const reader = new FileReader();
            reader.onload = (e) => config.sig = e.target.result;
            reader.readAsDataURL(input.files[0]);
        }

        function saveAdminSettings() {
            config.name = document.getElementById('setFarmName').value || config.name;
            config.price = document.getElementById('setBasePrice').value || config.price;
            config.wa = document.getElementById('setWANumber').value || config.wa;
            config.pass = document.getElementById('setAdminPass').value || config.pass;
            config.bot = document.getElementById('setBotInfo').value || config.bot;
            localStorage.setItem('farm_config', JSON.stringify(config));
            alert("ØªÙ… ØªØ­Ø¯ÙŠØ« ÙƒØ§ÙØ© ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø²Ø±Ø¹Ø©!");
            location.reload();
        }

        function renderAdmin() {
            const table = document.getElementById('dbTable');
            table.innerHTML = "";
            let income = 0;
            db.forEach((b, i) => {
                if(b.paid) income += b.total * 0.5;
                table.innerHTML += `<tr class="border-b border-white/5">
                    <td class="p-3">#${b.id.toString().padStart(4, '0')}</td>
                    <td class="p-3">${b.name}</td>
                    <td class="p-3 ${b.paid ? 'text-green-500' : 'text-amber-500'} font-bold">${b.status}</td>
                    <td class="p-3">
                        ${!b.paid ? `<button onclick="confirmPay(${i})" class="bg-green-600 px-3 py-1 rounded">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¯ÙØ¹ âœ…</button>` : `<button onclick="showReceipt(${i})" class="text-blue-400">ÙØªØ­ Ø§Ù„ÙˆØµÙ„</button>`}
                    </td>
                </tr>`;
            });
            document.getElementById('statCount').innerText = db.length;
            document.getElementById('statIncome').innerText = income.toLocaleString() + " Ø¯.Ø¹";
        }

        function confirmPay(i) {
            db[i].paid = true;
            db[i].status = "Ù…Ø¤ÙƒØ¯ (ØªÙ… Ø§Ù„Ø¯ÙØ¹)";
            localStorage.setItem('farm_db', JSON.stringify(db));
            renderAdmin();
        }

        function showReceipt(i) {
            const b = db[i];
            document.getElementById('rID').innerText = "#" + b.id.toString().padStart(4, '0');
            document.getElementById('rDate').innerText = b.date;
            document.getElementById('rCust').innerText = b.name;
            document.getElementById('rPaid').innerText = (b.total * 0.5).toLocaleString() + " Ø¯.Ø¹";
            document.getElementById('rRem').innerText = (b.total * 0.5).toLocaleString() + " Ø¯.Ø¹";
            document.getElementById('rSig').src = config.sig;
            document.getElementById('rFarmName').innerText = config.name;

            document.getElementById('qrcode').innerHTML = "";
            new QRCode(document.getElementById("qrcode"), { text: "Verify: "+b.id, width: 80, height: 80 });

            document.getElementById('receiptModal').style.display = 'flex';
        }

        // Chatbot Logic
        function toggleChat() { 
            const box = document.getElementById('aiChat');
            box.style.display = box.style.display === 'block' ? 'none' : 'block';
        }

        function aiResponse() {
            const inp = document.getElementById('chatInput');
            const cont = document.getElementById('chatContent');
            if(!inp.value) return;
            cont.innerHTML += `<p class="bg-amber-600/10 p-2 rounded-lg border border-amber-500/20 text-right">${inp.value}</p>`;
            setTimeout(() => {
                cont.innerHTML += `<p class="bg-white/5 p-2 rounded-lg">Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©: ${config.bot}</p>`;
                cont.scrollTop = cont.scrollHeight;
            }, 600);
            inp.value = "";
        }

        updatePriceDisplay();
    </script>
</body>
</html>
