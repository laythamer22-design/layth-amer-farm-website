<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù„ÙƒÙŠ | ROYAL RESORT</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;700;900&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        :root { --gold: #d4af37; --royal: #0c1421; }
        body { font-family: 'Tajawal', sans-serif; background: var(--royal); color: white; }
        .glass { background: rgba(255, 255, 255, 0.02); backdrop-filter: blur(20px); border: 1px solid rgba(255,255,255,0.1); }
        .admin-panel { display: none; position: fixed; inset: 0; z-index: 9999; background: #050a12; overflow-y: auto; padding: 2rem; }
        
        /* ØªØµÙ…ÙŠÙ… Ø§Ù„ÙˆØµÙ„ Ø§Ù„Ù…Ù„ÙƒÙŠ */
        #receiptPrint { background: white; color: black; padding: 3rem; width: 400px; border: 8px double #d4af37; border-radius: 2px; display: none; margin: 0 auto; position: relative; }
        .stamp-box { position: absolute; bottom: 40px; left: 40px; width: 100px; transform: rotate(-15deg); opacity: 0.8; }
        
        .btn-gold { background: linear-gradient(135deg, #d4af37 0%, #b8860b 100%); color: black; font-weight: 900; }
        .status-pending { color: #f59e0b; font-weight: bold; }
        .status-paid { color: #10b981; font-weight: bold; }
    </style>
</head>
<body>

    <nav class="fixed top-0 w-full z-50 glass border-b border-white/5 px-8 py-4 flex justify-between items-center">
        <h1 class="text-2xl font-black text-amber-500 italic">Ù…Ø²Ø±Ø¹Ø© <span id="mainTitle">Ø£Ø¨Ùˆ Ø³ÙŠÙ ÙˆØ£Ø¨Ùˆ Ù†Ù…Ø±</span></h1>
        <button onclick="openAdmin()" class="bg-amber-600/20 text-amber-500 p-2 rounded-lg border border-amber-600/30">âš™ï¸ Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</button>
    </nav>

    <section class="pt-32 px-6 max-w-7xl mx-auto space-y-12 text-center">
        <div class="rounded-[3rem] overflow-hidden border border-amber-600/30 shadow-2xl shadow-amber-900/20">
            <video autoplay muted loop class="w-full h-[60vh] object-cover">
                <source src="https://assets.mixkit.co/videos/preview/mixkit-luxury-villa-with-a-pool-at-sunset-2826-large.mp4" type="video/mp4">
            </video>
        </div>
    </section>

    <section id="bookingSection" class="max-w-4xl mx-auto py-20 px-6">
        <div class="glass p-10 rounded-[3rem] space-y-8 border-t-4 border-amber-500">
            <h2 class="text-3xl font-black text-center">Ø¨ÙˆØ§Ø¨Ø© Ø­Ø¬Ø² Ø§Ù„Ù†Ø®Ø¨Ø©</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <input type="text" id="uName" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„" class="bg-white/5 p-4 rounded-xl border border-white/10 outline-none focus:border-amber-500">
                <input type="tel" id="uPhone" placeholder="Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨" class="bg-white/5 p-4 rounded-xl border border-white/10 outline-none text-left" dir="ltr">
                <div class="col-span-1 md:col-span-2 flex gap-4">
                    <div class="flex-1 p-4 border border-dashed border-white/20 rounded-xl text-center cursor-pointer" onclick="document.getElementById('f1').click()">
                        <i data-lucide="upload" class="mx-auto w-4 h-4 opacity-40"></i>
                        <span class="text-[10px]">Ø±ÙØ¹ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù…ÙˆØ­Ø¯Ø©</span>
                        <input type="file" id="f1" class="hidden">
                    </div>
                    <div class="flex-1 p-4 border border-dashed border-white/20 rounded-xl text-center cursor-pointer" onclick="document.getElementById('f2').click()">
                        <i data-lucide="upload" class="mx-auto w-4 h-4 opacity-40"></i>
                        <span class="text-[10px]">Ø±ÙØ¹ Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø³ÙƒÙ†</span>
                        <input type="file" id="f2" class="hidden">
                    </div>
                </div>
            </div>
            <button onclick="requestBooking()" class="w-full btn-gold py-5 rounded-2xl text-xl transition-all hover:tracking-widest">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø¹Ø¨Ø± Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ Ù„Ù„ØªØ¯Ù‚ÙŠÙ‚ ğŸ“±</button>
            <p class="text-[10px] text-center text-gray-500 italic">Ø³ÙŠØªÙ… ØªØ¯Ù‚ÙŠÙ‚ Ø§Ù„Ù…Ø³ØªÙ…Ø³ÙƒØ§Øª Ù‚Ø¨Ù„ Ø¥ØµØ¯Ø§Ø± Ø§Ù„ÙˆØµÙ„ Ø§Ù„Ù…Ø§Ù„ÙŠ.</p>
        </div>
    </section>

    <div id="adminPanel" class="admin-panel text-white">
        <div class="max-w-6xl mx-auto space-y-10">
            <div class="flex justify-between items-center border-b border-white/10 pb-4">
                <h3 class="text-3xl font-black text-amber-500">Ù…Ù†Ø¸ÙˆÙ…Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø°ÙƒÙŠØ©</h3>
                <button onclick="document.getElementById('adminPanel').style.display='none'" class="text-red-500">Ø¥ØºÙ„Ø§Ù‚</button>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="glass p-6 rounded-2xl space-y-4">
                    <h4 class="text-xs font-bold uppercase text-amber-500">ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…Ø¯ÙŠØ±</h4>
                    <input type="text" id="setAdminWA" placeholder="Ø±Ù‚Ù… ÙˆØ§ØªØ³Ø§Ø¨ Ø§Ù„Ù…Ø²Ø±Ø¹Ø©" class="w-full bg-white/5 p-3 rounded-lg border border-white/10">
                    <div class="p-4 border border-dashed border-amber-600/30 rounded-lg text-center">
                        <p class="text-[10px] mb-2">Ø±ÙØ¹ Ø®ØªÙ…/ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ù…Ø¯ÙŠØ± (PNG Ø´ÙØ§Ù)</p>
                        <input type="file" id="sigInput" onchange="uploadSignature(this)">
                    </div>
                </div>
                <div class="glass p-6 rounded-2xl">
                    <h4 class="text-xs font-bold uppercase text-blue-400">Ù…Ù„Ø®Øµ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª</h4>
                    <div id="statsBox" class="mt-4 text-2xl font-black">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
                </div>
            </div>

            <div class="glass rounded-2xl overflow-hidden">
                <table class="w-full text-right text-sm">
                    <thead class="bg-amber-600 text-black font-bold">
                        <tr>
                            <th class="p-4">#</th>
                            <th class="p-4">Ø§Ù„Ø²Ø¨ÙˆÙ†</th>
                            <th class="p-4">Ø§Ù„Ø­Ø§Ù„Ø©</th>
                            <th class="p-4">Ø¥Ø¬Ø±Ø§Ø¡</th>
                        </tr>
                    </thead>
                    <tbody id="dbTable"></tbody>
                </table>
            </div>
        </div>
    </div>

    <div id="receiptContainer" class="fixed inset-0 bg-black/90 hidden z-[10000] flex items-center justify-center p-4">
        <div id="receiptPrint">
            <div class="text-center space-y-2 mb-6">
                <h1 id="rFarmName" class="text-2xl font-black tracking-tighter">Ù…Ø²Ø±Ø¹Ø© Ø£Ø¨Ùˆ Ø³ÙŠÙ ÙˆØ£Ø¨Ùˆ Ù†Ù…Ø±</h1>
                <p class="text-[10px] uppercase tracking-[5px] border-b border-black pb-2">ÙˆØµÙ„ Ù…Ø§Ù„ÙŠ Ø±Ø³Ù…ÙŠ - OFFICIAL RECEIPT</p>
            </div>
            <div class="space-y-3 text-[12px] font-mono">
                <div class="flex justify-between"><span>Ø±Ù‚Ù… Ø§Ù„ØªØ³Ù„Ø³Ù„:</span> <span id="rID" class="font-bold">#0001</span></div>
                <div class="flex justify-between"><span>Ø§Ù„Ø²Ø¨ÙˆÙ†:</span> <span id="rCust">-</span></div>
                <div class="flex justify-between"><span>Ø§Ù„ØªØ§Ø±ÙŠØ®:</span> <span id="rDate">-</span></div>
                <div class="flex justify-between border-t border-black pt-2"><span>Ø§Ù„Ù…Ù‚Ø¯Ù… (50%):</span> <span id="rPrice">75,000 IQD</span></div>
                <div class="flex justify-between text-gray-500"><span>Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ:</span> <span>75,000 IQD</span></div>
            </div>
            <div id="rQR" class="flex justify-center my-6"></div>
            <div class="text-[9px] text-center border-t border-dotted border-black pt-4">Ø­Ø§Ù„Ø© Ø§Ù„Ø¯ÙØ¹: Ù…Ø¤ÙƒØ¯Ø© Ù…Ù† Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© âœ…</div>
            
            <img id="sigImg" src="" class="stamp-box">
            
            <div class="mt-10 flex gap-2 no-print">
                <button onclick="window.print()" class="flex-1 bg-black text-white p-2 text-xs font-bold">Ø·Ø¨Ø§Ø¹Ø© / Ø­ÙØ¸</button>
                <button onclick="document.getElementById('receiptContainer').style.display='none'" class="flex-1 border border-black p-2 text-xs">Ø¥ØºÙ„Ø§Ù‚</button>
            </div>
        </div>
    </div>

    <script>
        lucide.createIcons();
        let farmAdminWA = "9647700000000";
        let signatureData = "";
        let bookings = JSON.parse(localStorage.getItem('royal_db')) || [];

        function uploadSignature(input) {
            const reader = new FileReader();
            reader.onload = function(e) { 
                signatureData = e.target.result; 
                document.getElementById('sigImg').src = signatureData;
            }
            reader.readAsDataURL(input.files[0]);
        }

        function requestBooking() {
            const name = document.getElementById('uName').value;
            const phone = document.getElementById('uPhone').value;
            if(!name || !phone) return alert("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª!");

            // Ø¥Ø¶Ø§ÙØ© Ø·Ù„Ø¨ Ø­Ø¬Ø² "Ù…Ø¹Ù„Ù‚" ÙÙŠ Ø§Ù„Ø³ÙŠØ³ØªÙ…
            const newReq = {
                id: bookings.length + 1,
                name: name,
                phone: phone,
                status: 'Ù…Ø¹Ù„Ù‚',
                date: new Date().toLocaleDateString('ar-EG')
            };
            bookings.push(newReq);
            localStorage.setItem('royal_db', JSON.stringify(bookings));

            // ØªÙˆØ¬ÙŠÙ‡ Ù„Ù„ÙˆØ§ØªØ³Ø§Ø¨ Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØµÙˆØ± ÙˆØ§Ù„Ø¯ÙØ¹
            const msg = `Ø·Ù„Ø¨ Ø­Ø¬Ø² Ø¬Ø¯ÙŠØ¯:\nØ§Ù„Ø§Ø³Ù…: ${name}\nØ§Ù„Ù‡Ø§ØªÙ: ${phone}\n(ÙŠØ±Ø¬Ù‰ Ø¥Ø±Ø³Ø§Ù„ ØµÙˆØ± Ø§Ù„Ù…Ø³ØªÙ…Ø³ÙƒØ§Øª Ù‡Ù†Ø§ ÙˆØ¥ÙƒÙ…Ø§Ù„ Ø¯ÙØ¹ Ø§Ù„Ø¹Ø±Ø¨ÙˆÙ† Ù„ØªÙØ¹ÙŠÙ„ Ø§Ù„ÙˆØµÙ„)`;
            window.open(`https://wa.me/${farmAdminWA}?text=${encodeURIComponent(msg)}`);
            alert("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨Ùƒ. Ø§Ù„ÙˆØµÙ„ Ø³ÙŠØµØ¯Ø± Ø¨Ø¹Ø¯ ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ù…Ø¯ÙŠØ± Ù„Ù„Ø¯ÙØ¹.");
        }

        function openAdmin() {
            let p = prompt("Ø£Ø¯Ø®Ù„ Ø±Ù…Ø² Ø§Ù„Ù…Ø¯ÙŠØ±:");
            if(p === "1234") {
                renderAdmin();
                document.getElementById('adminPanel').style.display = 'block';
            }
        }

        function renderAdmin() {
            const table = document.getElementById('dbTable');
            table.innerHTML = "";
            let income = 0;
            bookings.forEach((b, idx) => {
                if(b.status === 'ØªÙ… Ø§Ù„Ø¯ÙØ¹') income += 75000;
                table.innerHTML += `
                    <tr class="border-b border-white/5">
                        <td class="p-4 font-mono">#${b.id.toString().padStart(4, '0')}</td>
                        <td class="p-4">${b.name}</td>
                        <td class="p-4 ${b.status === 'Ù…Ø¹Ù„Ù‚' ? 'status-pending' : 'status-paid'}">${b.status}</td>
                        <td class="p-4">
                            ${b.status === 'Ù…Ø¹Ù„Ù‚' ? `<button onclick="approveBooking(${idx})" class="bg-green-600 px-3 py-1 rounded text-[10px]">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¯ÙØ¹ âœ…</button>` : `<button onclick="showReceipt(${idx})" class="bg-blue-600 px-3 py-1 rounded text-[10px]">Ø¹Ø±Ø¶ Ø§Ù„ÙˆØµÙ„</button>`}
                        </td>
                    </tr>
                `;
            });
            document.getElementById('statsBox').innerText = income.toLocaleString() + " Ø¯ÙŠÙ†Ø§Ø± Ø¹Ø±Ø§Ù‚ÙŠ";
        }

        function approveBooking(index) {
            bookings[index].status = 'ØªÙ… Ø§Ù„Ø¯ÙØ¹';
            localStorage.setItem('royal_db', JSON.stringify(bookings));
            renderAdmin();
            alert("ØªÙ… ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¯ÙØ¹. Ø§Ù„Ø¢Ù† ÙŠÙ…ÙƒÙ† Ù„Ù„Ø²Ø¨ÙˆÙ† Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„ÙˆØµÙ„.");
        }

        function showReceipt(index) {
            const b = bookings[index];
            document.getElementById('rID').innerText = "#" + b.id.toString().padStart(4, '0');
            document.getElementById('rCust').innerText = b.name;
            document.getElementById('rDate').innerText = b.date;
            
            document.getElementById('rQR').innerHTML = "";
            new QRCode(document.getElementById("rQR"), {
                text: "https://royal-farm-verify.com/id=" + b.id,
                width: 80, height: 80
            });

            document.getElementById('receiptContainer').style.display = 'flex';
            document.getElementById('receiptPrint').style.display = 'block';
        }
    </script>
</body>
</html>
