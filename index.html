<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø²Ø±Ø¹Ø© Ø£Ø¨Ùˆ Ø³ÙŠÙ ÙˆØ£Ø¨Ùˆ Ù†Ù…Ø± | Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        body { font-family: 'Tajawal', sans-serif; background: url('https://images.unsplash.com/photo-1500382017468-9049fed747ef?q=80&w=2000') no-repeat center center fixed; background-size: cover; color: white; }
        .overlay { background: rgba(2, 6, 23, 0.7); position: fixed; inset: 0; z-index: -1; }
        .glass { background: rgba(15, 23, 42, 0.8); backdrop-filter: blur(15px); border: 1px solid rgba(255,255,255,0.1); }
        .admin-panel { display: none; position: fixed; inset: 0; z-index: 9999; background: #020617; overflow-y: auto; padding: 2rem; }
        #receiptPrint { background: white; color: black; padding: 2.5rem; width: 380px; border: 5px double #d4af37; margin: 0 auto; position: relative; display: none; }
        .signature-img { position: absolute; bottom: 30px; left: 30px; width: 100px; opacity: 0.8; }
        .upload-active { border-color: #10b981 !important; background: rgba(16, 185, 129, 0.1); }
    </style>
</head>
<body>
    <div class="overlay"></div>

    <nav class="sticky top-0 z-50 glass border-b border-white/10 px-8 py-4 flex justify-between items-center">
        <h1 class="text-2xl font-black text-amber-500">Ù…Ø²Ø±Ø¹Ø© Ø£Ø¨Ùˆ Ø³ÙŠÙ ÙˆØ£Ø¨Ùˆ Ù†Ù…Ø±</h1>
        <button onclick="openAdmin()" class="bg-amber-600 px-4 py-2 rounded-xl font-bold text-xs">âš™ï¸ Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¯ÙŠØ±</button>
    </nav>

    <main class="max-w-7xl mx-auto p-6 space-y-20">
        <section class="space-y-6">
            <h2 class="text-3xl font-black text-center gold-text">Ù…Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø±ÙÙ‚Ø§Øª Ø§Ù„Ù…Ù„ÙƒÙŠØ©</h2>
            <div id="mediaGallery" class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <video controls class="col-span-1 md:col-span-3 w-full rounded-3xl border-2 border-amber-600/30">
                    <source src="https://assets.mixkit.co/videos/preview/mixkit-luxury-villa-with-a-pool-at-sunset-2826-large.mp4" type="video/mp4">
                </video>
                <img src="https://images.unsplash.com/photo-1582268611958-ebfd161ef9cf?q=80&w=1000" class="rounded-2xl h-48 w-full object-cover">
                <img src="https://images.unsplash.com/photo-1613490493576-7fde63acd811?q=80&w=1000" class="rounded-2xl h-48 w-full object-cover">
                <img src="https://images.unsplash.com/photo-1512917774080-9991f1c4c750?q=80&w=1000" class="rounded-2xl h-48 w-full object-cover">
            </div>
        </section>

        <section class="max-w-4xl mx-auto glass p-10 rounded-[3rem] space-y-8">
            <h3 class="text-2xl font-black text-center">Ø§Ø³ØªÙ…Ø§Ø±Ø© Ø§Ù„Ø­Ø¬Ø² ÙˆØ§Ù„ØªÙˆØ«ÙŠÙ‚</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <input type="text" id="custName" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„" class="bg-white/5 p-4 rounded-xl border border-white/10 outline-none focus:border-amber-500">
                <select id="custType" class="bg-slate-900 p-4 rounded-xl border border-white/10">
                    <option>Ø¹Ø§Ø¦Ù„Ø© ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦</option>
                    <option>Ø´Ø¨Ø§Ø¨ ğŸ‘¨â€ğŸ‘¦â€ğŸ‘¦</option>
                </select>
                <div id="boxId" class="border-2 border-dashed border-white/20 p-6 rounded-xl text-center cursor-pointer" onclick="document.getElementById('fileId').click()">
                    <span class="text-xs">Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù…ÙˆØ­Ø¯Ø©</span>
                    <input type="file" id="fileId" class="hidden" onchange="document.getElementById('boxId').classList.add('upload-active')">
                </div>
                <div id="boxHome" class="border-2 border-dashed border-white/20 p-6 rounded-xl text-center cursor-pointer" onclick="document.getElementById('fileHome').click()">
                    <span class="text-xs">Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø³ÙƒÙ†</span>
                    <input type="file" id="fileHome" class="hidden" onchange="document.getElementById('boxHome').classList.add('upload-active')">
                </div>
            </div>
            <button onclick="goToWhatsApp()" class="w-full bg-amber-600 py-5 rounded-2xl font-black text-xl shadow-lg">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ ÙˆØ§Ù„Ø¯ÙØ¹ (50%) ğŸ“±</button>
        </section>
    </main>

    <div id="adminPanel" class="admin-panel text-white">
        <div class="max-w-5xl mx-auto space-y-10">
            <div class="flex justify-between border-b border-white/10 pb-6">
                <h2 class="text-3xl font-black text-amber-500">Ø£Ø±Ø´ÙØ© Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª ÙˆØ§Ù„ØªØ­ÙƒÙ…</h2>
                <button onclick="document.getElementById('adminPanel').style.display='none'">Ø¥ØºÙ„Ø§Ù‚</button>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="glass p-6 rounded-2xl space-y-4">
                    <input type="text" id="waNumber" placeholder="Ø±Ù‚Ù… ÙˆØ§ØªØ³Ø§Ø¨ Ø§Ù„Ù…Ø²Ø±Ø¹Ø©" class="w-full bg-black/40 p-3 rounded-lg">
                    <p class="text-[10px]">Ø±ÙØ¹ ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ù…Ø¯ÙŠØ± (PNG)</p>
                    <input type="file" onchange="loadSig(this)">
                </div>
                <div class="glass p-6 rounded-2xl">
                    <p class="text-xs">Ø¯Ø®Ù„ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª Ø§Ù„Ù…Ø¤ÙƒØ¯Ø©</p>
                    <h4 id="incomeDisplay" class="text-3xl font-black text-green-500">0 Ø¯.Ø¹</h4>
                </div>
            </div>
            <div class="glass rounded-2xl overflow-hidden">
                <table class="w-full text-right text-sm">
                    <thead class="bg-amber-600 text-black">
                        <tr><th class="p-4">#</th><th class="p-4">Ø§Ù„Ø²Ø¨ÙˆÙ†</th><th class="p-4">Ø§Ù„Ø­Ø§Ù„Ø©</th><th class="p-4">Ø¥Ø¬Ø±Ø§Ø¡</th></tr>
                    </thead>
                    <tbody id="dbTable"></tbody>
                </table>
            </div>
        </div>
    </div>

    <div id="receiptModal" class="fixed inset-0 bg-black/95 hidden z-[10000] flex flex-col items-center justify-center p-4">
        <div id="receiptPrint">
            <div class="text-center mb-6">
                <h1 class="text-xl font-black">Ù…Ø²Ø±Ø¹Ø© Ø£Ø¨Ùˆ Ø³ÙŠÙ ÙˆØ£Ø¨Ùˆ Ù†Ù…Ø±</h1>
                <p class="text-[9px] border-b border-black pb-1">ÙˆØµÙ„ Ø­Ø¬Ø² Ø±Ø³Ù…ÙŠ - OFFICIAL RECEIPT</p>
            </div>
            <div class="space-y-2 text-[11px] font-mono">
                <div class="flex justify-between"><span>Ø§Ù„ØªØ³Ù„Ø³Ù„:</span> <span id="rID">#0001</span></div>
                <div class="flex justify-between"><span>Ø§Ù„Ù…Ø³ØªØ£Ø¬Ø±:</span> <span id="rName">-</span></div>
                <div class="flex justify-between"><span>Ø§Ù„Ù…Ù‚Ø¯Ù… (50%):</span> <span>75,000 Ø¯.Ø¹</span></div>
                <div class="flex justify-between"><span>Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ:</span> <span>75,000 Ø¯.Ø¹</span></div>
            </div>
            <div id="rQR" class="flex justify-center my-4"></div>
            <img id="rSig" src="" class="signature-img">
            <div class="mt-8 text-center no-print">
                <button onclick="window.print()" class="bg-black text-white px-6 py-2 text-xs">Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ÙˆØµÙ„</button>
            </div>
        </div>
        <button onclick="location.reload()" class="mt-6 text-white/50 text-xs no-print">Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ø¹Ø±Ø¶</button>
    </div>

    <script>
        lucide.createIcons();
        let db = JSON.parse(localStorage.getItem('farm_db')) || [];
        let adminWA = "9647700000000";
        let sigData = "";

        function loadSig(input) {
            const reader = new FileReader();
            reader.onload = (e) => sigData = e.target.result;
            reader.readAsDataURL(input.files[0]);
        }

        function goToWhatsApp() {
            const name = document.getElementById('custName').value;
            if(!name || !document.getElementById('fileId').files[0]) return alert("Ø£ÙƒÙ…Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ø±ÙØ¹ Ø§Ù„Ù…Ø³ØªÙ…Ø³ÙƒØ§Øª!");
            
            const newReq = { id: db.length + 1, name: name, status: 'Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø¯ÙØ¹', date: new Date().toLocaleDateString() };
            db.push(newReq);
            localStorage.setItem('farm_db', JSON.stringify(db));

            const msg = `Ø·Ù„Ø¨ Ø­Ø¬Ø² Ø¬Ø¯ÙŠØ¯ Ø¨Ø§Ø³Ù…: ${name}\nÙŠØ±Ø¬Ù‰ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ù…Ø³ØªÙ…Ø³ÙƒØ§Øª Ø§Ù„Ù…Ø±ÙÙ‚Ø© ÙˆØªØ£ÙƒÙŠØ¯ Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„Ù…Ù‚Ø¯Ù… (50%).`;
            window.open(`https://wa.me/${adminWA}?text=${encodeURIComponent(msg)}`);
        }

        function openAdmin() {
            if(prompt("Ø±Ù…Ø² Ø§Ù„Ù…Ø¯ÙŠØ±:") === "1234") {
                renderAdmin();
                document.getElementById('adminPanel').style.display = 'block';
            }
        }

        function renderAdmin() {
            const table = document.getElementById('dbTable');
            table.innerHTML = "";
            let income = 0;
            db.forEach((b, i) => {
                if(b.status === 'Ù…Ø¤ÙƒØ¯') income += 75000;
                table.innerHTML += `<tr class="border-b border-white/5">
                    <td class="p-4">#${b.id}</td>
                    <td class="p-4">${b.name}</td>
                    <td class="p-4">${b.status}</td>
                    <td class="p-4">
                        ${b.status === 'Ù…Ø¤ÙƒØ¯' ? `<button onclick="showReceipt(${i})" class="text-blue-400">Ø¹Ø±Ø¶ Ø§Ù„ÙˆØµÙ„</button>` : `<button onclick="confirmPay(${i})" class="text-green-500 font-bold">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¯ÙØ¹</button>`}
                    </td>
                </tr>`;
            });
            document.getElementById('incomeDisplay').innerText = income.toLocaleString() + " Ø¯.Ø¹";
        }

        function confirmPay(i) {
            db[i].status = 'Ù…Ø¤ÙƒØ¯';
            localStorage.setItem('farm_db', JSON.stringify(db));
            renderAdmin();
        }

        function showReceipt(i) {
            const b = db[i];
            document.getElementById('rID').innerText = "#" + b.id;
            document.getElementById('rName').innerText = b.name;
            document.getElementById('rSig').src = sigData;
            document.getElementById('rQR').innerHTML = "";
            new QRCode(document.getElementById("rQR"), { text: "https://farm.com/verify="+b.id, width: 70, height: 70 });
            document.getElementById('receiptModal').style.display = 'flex';
            document.getElementById('receiptPrint').style.display = 'block';
        }
    </script>
</body>
</html>
