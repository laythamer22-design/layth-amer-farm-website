<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Royal Oasis | Ù…Ø²Ø±Ø¹Ø© Ø£Ø¨Ùˆ Ø³ÙŠÙ ÙˆØ£Ø¨Ùˆ Ù†Ù…Ø±</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;700;900&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        :root { --gold: #c5a059; --dark: #050505; --accent: #1a1a1a; }
        
        /* Ø§Ù„Ø®Ù„ÙÙŠØ© Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠØ© Ù„Ù„Ù…ÙˆÙ‚Ø¹ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ */
        body { 
            font-family: 'Tajawal', sans-serif; 
            color: white; 
            scroll-behavior: smooth; 
            overflow-x: hidden;
            background: linear-gradient(rgba(0,0,0,0.8), rgba(0,0,0,0.8)), 
                        url('https://i.ibb.co/v4S6Y6Q/photo-4.jpg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed; /* ØªØ¬Ø¹Ù„ Ø§Ù„Ø®Ù„ÙÙŠØ© Ø«Ø§Ø¨ØªØ© Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªÙ…Ø±ÙŠØ± Ù„Ù…Ø¸Ù‡Ø± Ø¹ØµØ±ÙŠ */
            background-repeat: no-repeat;
        }

        .glass { background: rgba(0, 0, 0, 0.5); backdrop-filter: blur(15px); border: 1px solid rgba(255, 255, 255, 0.1); }
        .gold-text { background: linear-gradient(135deg, #fceabb, #f8b500); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .admin-modal { display: none; position: fixed; inset: 0; z-index: 9999; background: #050505; overflow-y: auto; padding: 2rem; }
        
        .auto-slider img { position: absolute; inset:0; opacity:0; transition: opacity 1.5s ease-in-out; width:100%; height:100%; object-fit:cover; }
        .auto-slider img.active { opacity:1; }

        #receiptUI { background: white; color: black; padding: 2.5rem; width: 400px; border: 10px double var(--gold); position: relative; }
        .sig-stamp { position: absolute; bottom: 30px; left: 30px; width: 100px; transform: rotate(-15deg); filter: grayscale(1); opacity: 0.7; }

        .chat-box { position: fixed; bottom: 20px; right: 20px; width: 300px; z-index: 50; display: none; }
        .map-point { position: absolute; background: #c5a059; width: 12px; height: 12px; border-radius: 50%; box-shadow: 0 0 15px #c5a059; animation: pulse 2s infinite; }
        @keyframes pulse { 0% { transform: scale(1); opacity: 1; } 100% { transform: scale(3); opacity: 0; } }

        .location-badge { background: linear-gradient(45deg, rgba(26,26,26,0.8), rgba(197,160,89,0.8)); border-radius: 50px; padding: 10px 25px; border: 1px solid rgba(255,255,255,0.1); }
    </style>
</head>
<body>

    <nav class="fixed top-0 w-full z-[100] glass border-b border-white/10 px-8 py-5 flex justify-between items-center">
        <div class="flex items-center gap-3">
            <div class="w-12 h-12 bg-gradient-to-br from-amber-400 to-amber-700 rounded-full flex items-center justify-center font-black text-black">AN</div>
            <h1 id="farmTitle" class="text-xl font-black gold-text italic tracking-tighter uppercase tracking-widest">Ø£Ø¨Ùˆ Ø³ÙŠÙ ÙˆØ£Ø¨Ùˆ Ù†Ù…Ø±</h1>
        </div>
        <div class="hidden md:flex items-center gap-6 text-[10px] font-bold uppercase tracking-widest">
            <a href="#gallery" class="hover:text-amber-500 transition">Ø§Ù„Ø£Ù„Ø¨ÙˆÙ…</a>
            <a href="#map-section" class="hover:text-amber-500 transition">Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ</a>
            <a href="#booking" class="hover:text-amber-500 transition">Ø­Ø¬Ø²</a>
            <button onclick="openAdmin()" class="bg-amber-600/20 text-amber-500 px-4 py-2 rounded-full border border-amber-500/30">Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</button>
        </div>
    </nav>

    <section class="h-screen flex flex-col items-center justify-center text-center px-4 bg-black/20">
        <h2 id="heroDisplay" class="text-6xl md:text-9xl font-black mb-4 gold-text drop-shadow-2xl">THE ROYAL OASIS</h2>
        <div class="location-badge mb-8 backdrop-blur-sm">
            <p id="locationText" class="text-sm md:text-xl font-bold tracking-[3px]">Ø£Ø·Ø±Ø§Ù Ø§Ù„ÙÙ„ÙˆØ¬Ø© Ø§Ù„Ø³ÙƒÙ†ÙŠØ©</p>
        </div>
        
        <div class="flex flex-wrap justify-center gap-4">
            <a href="https://maps.google.com/?q=33.375336,43.726315" target="_blank" class="flex items-center gap-2 bg-white text-black px-8 py-4 rounded-full font-black text-xs hover:bg-amber-500 transition-all shadow-xl">
                <i data-lucide="map-pin"></i> Google Maps
            </a>
            <a href="https://waze.com/ul?ll=33.3500,43.7833&navigate=yes" target="_blank" class="flex items-center gap-2 bg-[#33ccff] text-white px-8 py-4 rounded-full font-black text-xs hover:shadow-[0_0_20px_rgba(51,204,255,0.5)] transition-all">
                <i data-lucide="navigation"></i> Waze
            </a>
        </div>
    </section>

    <section id="gallery" class="py-20 max-w-7xl mx-auto px-6 space-y-10">
        <div class="relative h-[70vh] rounded-[4rem] overflow-hidden glass p-4 border border-amber-500/20 auto-slider shadow-2xl" id="mainSlider">
            <img src="https://i.ibb.co/v4S6Y6Q/photo-4.jpg" class="active">
            <img src="https://i.ibb.co/C0mXm6H/photo-6.jpg">
            <img src="https://i.ibb.co/mFm7X8J/photo-10.jpg">
            <img src="https://i.ibb.co/C9GzX9V/photo-8.jpg">
        </div>

        <div class="rounded-[4rem] overflow-hidden glass p-4 border border-amber-500/20 shadow-2xl mt-10">
            <video id="mainVideo" autoplay muted loop class="w-full h-[60vh] object-cover rounded-[3rem]">
                <source src="https://assets.mixkit.co/videos/preview/mixkit-luxury-villa-with-a-pool-at-sunset-2826-large.mp4" type="video/mp4">
            </video>
        </div>

        <div id="imageAlbum" class="grid grid-cols-2 md:grid-cols-4 gap-4">
            <img src="https://i.ibb.co/v4S6Y6Q/photo-4.jpg" class="rounded-3xl h-48 w-full object-cover border border-white/10 hover:border-amber-500 transition cursor-pointer">
            <img src="https://i.ibb.co/C0mXm6H/photo-6.jpg" class="rounded-3xl h-48 w-full object-cover border border-white/10 hover:border-amber-500 transition cursor-pointer">
            <img src="https://i.ibb.co/mFm7X8J/photo-10.jpg" class="rounded-3xl h-48 w-full object-cover border border-white/10 hover:border-amber-500 transition cursor-pointer">
            <img src="https://i.ibb.co/C9GzX9V/photo-8.jpg" class="rounded-3xl h-48 w-full object-cover border border-white/10 hover:border-amber-500 transition cursor-pointer">
        </div>
    </section>

    <section id="map-section" class="py-20 max-w-7xl mx-auto px-6">
        <div class="text-center mb-10">
            <h3 class="text-3xl font-black gold-text italic">Ø®Ø§Ø±Ø·Ø© Ø§Ù„Ø±ÙØ§Ù‡ÙŠØ©</h3>
            <p class="text-gray-300">ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…Ø±Ø§ÙÙ‚ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ ÙÙŠ Ù…Ø²Ø±Ø¹ØªÙ†Ø§</p>
        </div>
        <div class="relative rounded-[3rem] overflow-hidden border border-white/10 glass h-[500px]">
            <img id="mapImg" src="https://i.ibb.co/mFm7X8J/photo-10.jpg" class="w-full h-full object-cover opacity-30">
            <div class="map-point top-1/4 left-1/3" title="Ø§Ù„Ù…Ø³Ø¨Ø­"></div>
            <div class="map-point top-1/2 right-1/4" title="ØµØ§Ù„Ø© Ø§Ù„Ù€ VIP"></div>
            <div class="map-point bottom-1/4 left-1/2" title="Ø§Ù„Ø­Ø¯Ø§Ø¦Ù‚ Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ©"></div>
        </div>
    </section>

    <section id="booking" class="py-32 max-w-5xl mx-auto px-6">
        <div class="glass p-12 rounded-[4rem] border-t-2 border-amber-500/50 shadow-2xl space-y-10">
            <div class="text-center">
                <h3 class="text-4xl font-black mb-2">ØªØ«Ø¨ÙŠØª Ø­Ø¬Ø² Ù…Ù„ÙƒÙŠ</h3>
                <p class="text-amber-500 font-bold">50% Ù…Ù‚Ø¯Ù… Ù„ØªØ«Ø¨ÙŠØª Ø§Ù„Ø­Ø¬Ø² - 50% Ø¹Ù†Ø¯ Ø§Ù„Ù…ØºØ§Ø¯Ø±Ø©</p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="space-y-4">
                    <input type="text" id="custName" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„" class="w-full bg-white/10 p-5 rounded-2xl border border-white/10 outline-none focus:border-amber-500 text-white placeholder:text-gray-400">
                    <input type="text" id="custPhone" placeholder="Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ Ù„Ù„ØªÙˆØ§ØµÙ„ ÙˆØ§Ù„ØªØ°ÙƒÙŠØ±" class="w-full bg-white/10 p-5 rounded-2xl border border-white/10 outline-none focus:border-amber-500 text-white placeholder:text-gray-400">
                    <select id="custType" class="w-full bg-black/60 p-5 rounded-2xl border border-white/10 text-white">
                        <option class="bg-gray-900">Ø¹Ø§Ø¦Ù„Ø© ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦</option>
                        <option class="bg-gray-900">Ø´Ø¨Ø§Ø¨ ğŸ‘¨â€ğŸ‘¦â€ğŸ‘¦</option>
                    </select>
                    <div class="grid grid-cols-2 gap-4">
                        <select id="custDuration" class="bg-black/60 p-5 rounded-2xl border border-white/10 text-white" onchange="toggleFatra()">
                            <option value="1" class="bg-gray-900">ÙŠÙˆÙ… ÙƒØ§Ù…Ù„ (24Ø³)</option>
                            <option value="0.5" class="bg-gray-900">Ù†ØµÙ ÙŠÙˆÙ… (12Ø³)</option>
                        </select>
                        <select id="selectedFatra" class="hidden bg-amber-600/40 p-5 rounded-2xl border border-amber-500/30 text-white">
                            <option value="ØµØ¨Ø§Ø­ÙŠ" class="bg-gray-900">Ø­Ø¬Ø² ØµØ¨Ø§Ø­ÙŠ</option>
                            <option value="Ù…Ø³Ø§Ø¦ÙŠ" class="bg-gray-900">Ø­Ø¬Ø² Ù…Ø³Ø§Ø¦ÙŠ</option>
                        </select>
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-4 text-center">
                    <label id="labelId" class="border-2 border-dashed border-white/20 p-8 rounded-3xl cursor-pointer hover:border-amber-500 transition-all bg-black/20">
                        <i data-lucide="contact-2" class="mx-auto mb-2 opacity-50"></i>
                        <span class="text-[10px] block uppercase">Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù…ÙˆØ­Ø¯Ø©</span>
                        <input type="file" id="inputId" class="hidden" onchange="uploadDone('labelId')">
                    </label>
                    <label id="labelHome" class="border-2 border-dashed border-white/20 p-8 rounded-3xl cursor-pointer hover:border-amber-500 transition-all bg-black/20">
                        <i data-lucide="home" class="mx-auto mb-2 opacity-50"></i>
                        <span class="text-[10px] block uppercase">Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø³ÙƒÙ†</span>
                        <input type="file" id="inputHome" class="hidden" onchange="uploadDone('labelHome')">
                    </label>
                </div>
            </div>

            <div class="bg-amber-500/20 p-6 rounded-3xl border border-amber-500/20 flex justify-between items-center backdrop-blur-md">
                <div>
                    <p class="text-xs text-gray-300">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: <span id="totalVal">150,000</span> Ø¯.Ø¹</p>
                    <p class="text-lg font-black text-amber-500">Ø§Ù„Ù…Ù‚Ø¯Ù… (50%): <span id="downVal">75,000</span> Ø¯.Ø¹</p>
                </div>
                <button onclick="requestWhatsApp()" class="bg-amber-600 px-10 py-4 rounded-2xl font-black text-black shadow-xl hover:scale-105 transition-all">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¬Ø² ÙˆØ§Ù„Ø¯ÙØ¹ ğŸ’³</button>
            </div>
        </div>
    </section>

    <div id="aiChat" class="chat-box glass p-4 rounded-3xl border border-amber-500/30 shadow-2xl">
        <div class="flex justify-between items-center mb-4 border-b border-white/10 pb-2">
            <span class="text-xs font-black gold-text italic">Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ù…Ø²Ø±Ø¹Ø© Ø§Ù„Ø°ÙƒÙŠ</span>
            <button onclick="toggleChat()" class="text-gray-400">Ã—</button>
        </div>
        <div id="chatContent" class="h-48 overflow-y-auto text-[10px] space-y-2 mb-4">
            <p class="bg-white/10 p-2 rounded-lg">Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ! Ø£Ù†Ø§ Ø§Ù„Ø¨ÙˆØª Ø§Ù„Ø®Ø§Øµ Ø¨Ù…Ø²Ø±Ø¹Ø© Ø£Ø¨Ùˆ Ø³ÙŠÙ ÙˆØ£Ø¨Ùˆ Ù†Ù…Ø±. Ø§Ø³Ø£Ù„Ù†ÙŠ Ø¹Ù† Ø§Ù„Ù…Ø±Ø§ÙÙ‚ Ø£Ùˆ Ø§Ù„Ø£Ø³Ø¹Ø§Ø±.</p>
        </div>
        <div class="flex gap-2">
            <input type="text" id="chatInput" placeholder="Ø§Ø³Ø£Ù„Ù†ÙŠ Ø£ÙŠ Ø´ÙŠØ¡..." class="flex-1 bg-black/60 border border-white/10 p-2 rounded-xl text-xs outline-none text-white">
            <button onclick="aiResponse()" class="bg-amber-600 p-2 rounded-xl"><i data-lucide="send" class="w-4 h-4 text-black"></i></button>
        </div>
    </div>
    
    <button onclick="toggleChat()" class="fixed bottom-6 right-6 w-14 h-14 bg-amber-600 rounded-full flex items-center justify-center shadow-2xl z-50">
        <i data-lucide="bot" class="text-black"></i>
    </button>

    <div id="adminPanel" class="admin-modal">
        <div class="max-w-6xl mx-auto space-y-10 pb-20">
            <div class="flex justify-between items-center border-b border-white/10 pb-6">
                <h2 class="text-4xl font-black gold-text italic uppercase">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø³ÙŠØ·Ø±Ø© Ø§Ù„Ù…Ù„ÙƒÙŠØ©</h2>
                <button onclick="document.getElementById('adminPanel').style.display='none'" class="bg-red-600/20 text-red-500 px-6 py-2 rounded-full font-bold">Ø¥ØºÙ„Ø§Ù‚</button>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 text-center">
                <div class="glass p-6 rounded-3xl"><p class="text-xs text-gray-500">Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª</p><h4 id="statCount" class="text-3xl font-black">0</h4></div>
                <div class="glass p-6 rounded-3xl"><p class="text-xs text-gray-500">Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ (Ø§Ù„Ù…Ù‚Ø¯Ù…Ø§Øª)</p><h4 id="statIncome" class="text-3xl font-black text-green-500">0 Ø¯.Ø¹</h4></div>
                <div class="glass p-6 rounded-3xl"><p class="text-xs text-gray-500">Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø­Ø§Ù„ÙŠ</p><h4 id="currentLocDisplay" class="text-xs font-bold text-amber-500 mt-2">Ø£Ø·Ø±Ø§Ù Ø§Ù„ÙÙ„ÙˆØ¬Ø© Ø§Ù„Ø³ÙƒÙ†ÙŠØ©</h4></div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <div class="glass p-8 rounded-[3rem] space-y-6">
                    <h4 class="font-black text-amber-500 uppercase tracking-widest border-b border-white/10 pb-2">ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰</h4>
                    <div class="grid grid-cols-2 gap-4">
                        <input type="text" id="setFarmName" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø²Ø±Ø¹Ø©" class="bg-white/5 p-4 rounded-xl border border-white/10 text-xs">
                        <input type="text" id="setLocText" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…ÙˆÙ‚Ø¹ (Ø£Ø·Ø±Ø§Ù Ø§Ù„ÙÙ„ÙˆØ¬Ø©)" class="bg-white/5 p-4 rounded-xl border border-white/10 text-xs">
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <input type="text" id="timeM" placeholder="ØªÙˆÙ‚ÙŠØª Ø§Ù„ØµØ¨Ø§Ø­ÙŠ (8Øµ-8Ù…)" class="bg-white/5 p-4 rounded-xl border border-white/10 text-xs">
                        <input type="text" id="timeE" placeholder="ØªÙˆÙ‚ÙŠØª Ø§Ù„Ù…Ø³Ø§Ø¦ÙŠ (8Ù…-8Øµ)" class="bg-white/5 p-4 rounded-xl border border-white/10 text-xs">
                    </div>
                    <input type="text" id="setWANumber" placeholder="Ø±Ù‚Ù… ÙˆØ§ØªØ³Ø§Ø¨ Ø§Ù„Ù…Ø¯ÙŠØ±" class="w-full bg-white/5 p-4 rounded-xl border border-white/10 text-xs">
                    <button onclick="saveAdminSettings()" class="w-full bg-amber-600 py-4 rounded-2xl font-black text-black">Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª âœ…</button>
                </div>

                <div class="glass p-8 rounded-[3rem] space-y-6 overflow-hidden">
                    <h4 class="font-black text-blue-500 uppercase tracking-widest border-b border-white/10 pb-2">Ø§Ù„Ø²Ø¨Ø§Ø¦Ù† ÙˆØ§Ù„ØªØ°ÙƒÙŠØ± Ø§Ù„Ø°ÙƒÙŠ</h4>
                    <div class="overflow-x-auto h-80">
                        <table class="w-full text-right text-[10px]">
                            <thead class="bg-white/5">
                                <tr><th class="p-3">Ø§Ù„Ø²Ø¨ÙˆÙ†</th><th class="p-3">Ø§Ù„ÙØªØ±Ø©</th><th class="p-3">Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡</th></tr>
                            </thead>
                            <tbody id="dbTable"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="receiptModal" class="fixed inset-0 z-[10001] bg-black/95 hidden flex flex-col items-center justify-center p-6">
        <div id="receiptUI">
            <div class="text-center mb-6 border-b border-black pb-4">
                <h2 id="rFarmName" class="text-2xl font-black italic">Ø£Ø¨Ùˆ Ø³ÙŠÙ ÙˆØ£Ø¨Ùˆ Ù†Ù…Ø±</h2>
                <p class="text-[9px] uppercase tracking-[3px]">ÙØ§ØªÙˆØ±Ø© Ø­Ø¬Ø² - OFFICIAL INVOICE</p>
            </div>
            <div class="space-y-3 text-[11px] font-mono">
                <div class="flex justify-between"><span>Ø§Ù„Ø§Ø³Ù…:</span> <span id="rCust">-</span></div>
                <div class="flex justify-between"><span>Ø§Ù„ÙØªØ±Ø©:</span> <span id="rTime">-</span></div>
                <div class="flex justify-between font-bold border-t border-black pt-2"><span>Ø§Ù„Ù…Ù‚Ø¯Ù… (50%):</span> <span id="rPaid">-</span></div>
            </div>
            <div id="qrcode" class="flex justify-center my-6"></div>
            <img id="rSig" src="" class="sig-stamp">
            <p class="text-[7px] text-center border-t border-dotted border-black pt-4 italic">Ø³ÙŠØµÙ„Ùƒ Ø¥Ø´Ø¹Ø§Ø± ØªØ°ÙƒÙŠØ± Ù‚Ø¨Ù„ 24 Ø³Ø§Ø¹Ø© Ù…Ù† Ø§Ù„Ù…ÙˆØ¹Ø¯ ğŸ””</p>
            <div class="mt-8 no-print flex gap-2">
                <button onclick="window.print()" class="flex-1 bg-black text-white py-2 rounded-lg text-xs">Ø­ÙØ¸ PDF</button>
                <button onclick="location.reload()" class="flex-1 border border-black py-2 rounded-lg text-xs">Ø¥ØºÙ„Ø§Ù‚</button>
            </div>
        </div>
    </div>

    <script>
        lucide.createIcons();
        
        // Scripts remain unchanged to maintain previous logic
        let db = JSON.parse(localStorage.getItem('farm_db_final')) || [];
        let config = JSON.parse(localStorage.getItem('farm_config_final')) || {
            name: "Ø£Ø¨Ùˆ Ø³ÙŠÙ ÙˆØ£Ø¨Ùˆ Ù†Ù…Ø±",
            loc: "Ø£Ø·Ø±Ø§Ù Ø§Ù„ÙÙ„ÙˆØ¬Ø© Ø§Ù„Ø³ÙƒÙ†ÙŠØ©",
            price: 150000,
            wa: "9647700000000",
            pass: "1234",
            bot: "Ø§Ù„Ù…Ø²Ø±Ø¹Ø© ÙÙŠ Ø£Ø·Ø±Ø§Ù Ø§Ù„ÙÙ„ÙˆØ¬Ø©ØŒ Ù…Ø³Ø¨Ø­ Ù…Ù„ÙƒÙŠØŒ Ø¥Ù‚Ø§Ù…Ø© VIP. 50% Ù…Ù‚Ø¯Ù….",
            timeM: "8 ØµØ¨Ø§Ø­Ø§Ù‹ - 8 Ù…Ø³Ø§Ø¡Ù‹",
            timeE: "8 Ù…Ø³Ø§Ø¡Ù‹ - 8 ØµØ¨Ø§Ø­Ø§Ù‹",
            sig: ""
        };

        document.getElementById('farmTitle').innerText = config.name;
        document.getElementById('heroDisplay').innerText = config.name.toUpperCase();
        document.getElementById('locationText').innerText = config.loc;

        let currentSlide = 0;
        const slides = document.querySelectorAll('.auto-slider img');
        setInterval(() => {
            slides[currentSlide].classList.remove('active');
            currentSlide = (currentSlide + 1) % slides.length;
            slides[currentSlide].classList.add('active');
        }, 4000);

        function toggleFatra() {
            const isHalf = document.getElementById('custDuration').value == "0.5";
            document.getElementById('selectedFatra').classList.toggle('hidden', !isHalf);
            const total = isHalf ? 80000 : 150000;
            document.getElementById('totalVal').innerText = total.toLocaleString();
            document.getElementById('downVal').innerText = (total * 0.5).toLocaleString();
        }

        function uploadDone(id) {
            const el = document.getElementById(id);
            el.classList.add('bg-green-600/20', 'border-green-500');
            el.innerHTML = '<i data-lucide="check-circle" class="mx-auto text-green-500 mb-2"></i><span class="text-[10px] text-green-500">ØªÙ… Ø§Ù„Ø±ÙØ¹</span>';
            lucide.createIcons();
        }

        function requestWhatsApp() {
            const name = document.getElementById('custName').value;
            const phone = document.getElementById('custPhone').value;
            if(!name || !phone) return alert("ÙŠØ±Ø¬Ù‰ Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª!");

            const newBooking = {
                id: db.length + 1,
                name: name,
                phone: phone,
                fatra: document.getElementById('custDuration').value == "1" ? "ÙŠÙˆÙ… ÙƒØ§Ù…Ù„" : document.getElementById('selectedFatra').value,
                paid: false,
                total: document.getElementById('custDuration').value == "1" ? 150000 : 80000
            };
            db.push(newBooking);
            localStorage.setItem('farm_db_final', JSON.stringify(db));

            const msg = `Ø·Ù„Ø¨ Ø­Ø¬Ø² Ø¬Ø¯ÙŠØ¯ Ø¨Ø§Ø³Ù…: ${name}\nØ§Ù„Ù‡Ø§ØªÙ: ${phone}\nØ§Ù„ÙØªØ±Ø©: ${newBooking.fatra}\nØ§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø·Ù„ÙˆØ¨: ${newBooking.total * 0.5} Ø¯.Ø¹\nØªÙ†Ø¨ÙŠÙ‡: Ø³ÙŠØµÙ„ ØªØ°ÙƒÙŠØ± Ù„Ù„Ø·Ø±ÙÙŠÙ† Ù‚Ø¨Ù„ 24 Ø³Ø§Ø¹Ø©.`;
            window.open(`https://wa.me/${config.wa}?text=${encodeURIComponent(msg)}`);
        }

        function openAdmin() {
            if(prompt("Ø±Ù…Ø² Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø¯ÙŠØ±:") === config.pass) {
                renderAdmin();
                document.getElementById('adminPanel').style.display = 'block';
            }
        }

        function saveAdminSettings() {
            config.name = document.getElementById('setFarmName').value || config.name;
            config.loc = document.getElementById('setLocText').value || config.loc;
            config.wa = document.getElementById('setWANumber').value || config.wa;
            config.timeM = document.getElementById('timeM').value || config.timeM;
            config.timeE = document.getElementById('timeE').value || config.timeE;
            localStorage.setItem('farm_config_final', JSON.stringify(config));
            alert("ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ«!"); location.reload();
        }

        function renderAdmin() {
            const table = document.getElementById('dbTable');
            table.innerHTML = "";
            let income = 0;
            db.forEach((b, i) => {
                if(b.paid) income += (b.total * 0.5);
                table.innerHTML += `<tr class="border-b border-white/5">
                    <td class="p-3">${b.name}</td>
                    <td class="p-3">${b.fatra}</td>
                    <td class="p-3 flex gap-1">
                        ${!b.paid ? `<button onclick="confirmPay(${i})" class="bg-green-600 p-1 rounded">âœ…</button>` : `<button onclick="showReceipt(${i})" class="bg-blue-600 p-1 rounded">ğŸ“„</button>`}
                        <button onclick="sendWAReminder(${i})" title="Ø¥Ø±Ø³Ø§Ù„ ØªØ°ÙƒÙŠØ± 24 Ø³Ø§Ø¹Ø©" class="bg-amber-600 p-1 rounded"><i data-lucide="bell" class="w-3 h-3"></i></button>
                    </td>
                </tr>`;
            });
            document.getElementById('statCount').innerText = db.length;
            document.getElementById('statIncome').innerText = income.toLocaleString() + " Ø¯.Ø¹";
            lucide.createIcons();
        }

        function confirmPay(i) {
            db[i].paid = true;
            localStorage.setItem('farm_db_final', JSON.stringify(db));
            renderAdmin();
        }

        function sendWAReminder(i) {
            const b = db[i];
            const reminder = `ØªØ°ÙƒÙŠØ± Ø­Ø¬Ø² (24 Ø³Ø§Ø¹Ø©) ğŸ””\nØ¹Ø²ÙŠØ²ÙŠ ${b.name}ØŒ Ù†ÙˆØ¯ ØªØ°ÙƒÙŠØ±Ùƒ Ø¨Ù…ÙˆØ¹Ø¯ Ø­Ø¬Ø²Ùƒ ØºØ¯Ø§Ù‹ ÙÙŠ ${config.name}.\nØ§Ù„Ù…ÙƒØ§Ù†: ${config.loc}\nØ®Ø±ÙŠØ·Ø© Ø§Ù„ÙˆØµÙˆÙ„: https://maps.google.com/?q=33.375336,43.726315`;
            window.open(`https://wa.me/${b.phone}?text=${encodeURIComponent(reminder)}`);
        }

        function showReceipt(i) {
            const b = db[i];
            document.getElementById('rCust').innerText = b.name;
            document.getElementById('rTime').innerText = b.fatra;
            document.getElementById('rPaid').innerText = (b.total * 0.5).toLocaleString() + " Ø¯.Ø¹";
            document.getElementById('rFarmName').innerText = config.name;
            document.getElementById('qrcode').innerHTML = "";
            new QRCode(document.getElementById("qrcode"), { text: "Verified: " + b.name, width: 80, height: 80 });
            document.getElementById('receiptModal').style.display = 'flex';
        }

        function toggleChat() { 
            const box = document.getElementById('aiChat');
            box.style.display = box.style.display === 'block' ? 'none' : 'block';
        }

        function aiResponse() {
            const inp = document.getElementById('chatInput');
            const cont = document.getElementById('chatContent');
            if(!inp.value) return;
            cont.innerHTML += `<p class="bg-amber-600/10 p-2 rounded-lg border border-amber-500/20 text-right">${inp.value}</p>`;
            setTimeout(() => {
                cont.innerHTML += `<p class="bg-white/5 p-2 rounded-lg">Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©: ${config.bot}</p>`;
                cont.scrollTop = cont.scrollHeight;
            }, 600);
            inp.value = "";
        }
    </script>
</body>
</html>
