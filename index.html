<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Royal Oasis | نظام الإدارة الملكي</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;700;900&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        :root { --gold: #c5a059; --dark: #050505; --accent: #1a1a1a; }
        body { font-family: 'Tajawal', sans-serif; color: white; scroll-behavior: smooth; overflow-x: hidden; background-color: var(--dark); }
        .main-bg-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; background-size: cover; background-position: center; transition: 1s ease; }
        .overlay { position: fixed; inset: 0; background: linear-gradient(rgba(0,0,0,0.4), rgba(5,5,5,0.95)); z-index: -1; }
        .glass { background: rgba(255, 255, 255, 0.03); backdrop-filter: blur(15px); border: 1px solid rgba(255, 255, 255, 0.1); }
        .gold-text { background: linear-gradient(135deg, #fceabb, #f8b500); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .admin-modal { display: none; position: fixed; inset: 0; z-index: 9999; background: #080808; overflow-y: auto; }
        .tab-btn.active { border-bottom: 3px solid var(--gold); color: var(--gold); }
        .category-badge { background: rgba(197, 160, 89, 0.1); border: 1px solid var(--gold); color: var(--gold); padding: 2px 10px; border-radius: 5px; font-size: 10px; }
    </style>
</head>
<body onload="initApp()">

    <div id="dynamicBg" class="main-bg-container"></div>
    <div class="overlay"></div>

    <nav class="fixed top-0 w-full z-[100] glass border-b border-white/10 px-8 py-4 flex justify-between items-center">
        <div class="flex items-center gap-4">
            <div class="w-12 h-12 bg-gradient-to-br from-amber-200 to-amber-900 rounded-xl rotate-45 flex items-center justify-center">
                <span class="rotate-[-45deg] font-black text-black">RO</span>
            </div>
            <div>
                <h1 id="farmTitle" class="text-xl font-black gold-text">المزرعة الملكية</h1>
            </div>
        </div>
        <div class="flex gap-6 items-center">
            <button onclick="openAdmin()" class="text-[10px] border border-amber-500/30 px-4 py-2 rounded-lg hover:bg-amber-600 hover:text-black transition">لوحة التحكم</button>
        </div>
    </nav>

    <section class="h-screen flex flex-col items-center justify-center text-center px-4">
        <h2 id="heroDisplay" class="text-6xl md:text-9xl font-black mb-6 gold-text italic">ROYAL OASIS</h2>
        <div class="location-badge mb-10">
            <p id="locationText" class="text-black font-bold px-6 py-2 bg-amber-500 rounded-full">أطراف الفلوجة</p>
        </div>
    </section>

    <section id="gallery" class="py-20 max-w-7xl mx-auto px-6">
        <div class="text-center mb-12">
            <h3 class="text-4xl font-black gold-text mb-2">الكتالوج الملكي المطور</h3>
            <p class="text-gray-500">تمتع بمشاهدة مرافقنا مقسمة حسب الفخامة</p>
        </div>
        
        <div id="catalogGrid" class="grid grid-cols-1 md:grid-cols-3 gap-6">
            </div>
    </section>

    <div id="adminPanel" class="admin-modal">
        <div class="max-w-6xl mx-auto p-8">
            <div class="flex justify-between items-center border-b border-white/10 pb-6 mb-8">
                <div>
                    <h2 class="text-3xl font-black gold-text italic">غرفة العمليات الملكية</h2>
                    <p class="text-gray-500 text-sm">أهلاً بك يا مدير، كل شيء تحت سيطرتك هنا</p>
                </div>
                <button onclick="closeAdmin()" class="bg-red-500/10 text-red-500 px-6 py-2 rounded-xl border border-red-500/50">إغلاق اللوحة</button>
            </div>

            <div class="flex gap-8 mb-10 border-b border-white/5">
                <button onclick="switchTab('tab-stats')" class="tab-btn active pb-4 font-bold">المؤشرات المالية</button>
                <button onclick="switchTab('tab-settings')" class="tab-btn pb-4 font-bold">إعدادات الموقع</button>
                <button onclick="switchTab('tab-media')" class="tab-btn pb-4 font-bold">بوابات الصور والثيم</button>
                <button onclick="switchTab('tab-archive')" class="tab-btn pb-4 font-bold">أرشيف الحجوزات</button>
            </div>

            <div id="tab-stats" class="tab-content">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-10">
                    <div class="glass p-8 rounded-3xl border-r-4 border-green-500">
                        <p class="text-gray-500 text-xs mb-1">الواصل الفعلي (50%)</p>
                        <h4 id="statIncome" class="text-3xl font-black text-green-500">0 د.ع</h4>
                    </div>
                    <div class="glass p-8 rounded-3xl border-r-4 border-amber-500">
                        <p class="text-gray-500 text-xs mb-1">المتبقي في ذمة الزبائن</p>
                        <h4 id="statDebt" class="text-3xl font-black text-amber-500">0 د.ع</h4>
                    </div>
                    <div class="glass p-8 rounded-3xl border-r-4 border-blue-500">
                        <p class="text-gray-500 text-xs mb-1">إجمالي قيمة الحجوزات</p>
                        <h4 id="statTotal" class="text-3xl font-black text-blue-500">0 د.ع</h4>
                    </div>
                </div>
            </div>

            <div id="tab-settings" class="tab-content hidden grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="space-y-4">
                    <label class="block text-amber-500 text-xs font-bold">اسم المزرعة التجاري</label>
                    <input type="text" id="setFarmName" class="w-full bg-white/5 p-4 rounded-xl border border-white/10 outline-none focus:border-amber-500">
                    
                    <label class="block text-amber-500 text-xs font-bold">سعر الحجز (يوم كامل)</label>
                    <input type="number" id="setPrice" class="w-full bg-white/5 p-4 rounded-xl border border-white/10 outline-none">

                    <label class="block text-amber-500 text-xs font-bold">موقع المزرعة (النص الظاهر)</label>
                    <input type="text" id="setLoc" class="w-full bg-white/5 p-4 rounded-xl border border-white/10 outline-none">
                </div>
                <div class="space-y-4">
                    <label class="block text-amber-500 text-xs font-bold">رقم الواتساب الخاص بالإدارة</label>
                    <input type="text" id="setWA" class="w-full bg-white/5 p-4 rounded-xl border border-white/10 outline-none">
                    
                    <label class="block text-amber-500 text-xs font-bold">كلمة مرور لوحة التحكم</label>
                    <input type="password" id="setPass" class="w-full bg-white/5 p-4 rounded-xl border border-white/10 outline-none">

                    <button onclick="saveAdminSettings()" class="w-full bg-amber-600 py-4 rounded-xl text-black font-black mt-4">حفظ كافة التغييرات</button>
                </div>
            </div>

            <div id="tab-media" class="tab-content hidden space-y-12">
                <div class="glass p-8 rounded-3xl border border-blue-500/30">
                    <h4 class="text-xl font-black mb-4 flex items-center gap-2"><i data-lucide="image"></i> بوابة الثيم العام للموقع</h4>
                    <p class="text-xs text-gray-500 mb-4">هذه الصورة ستكون الخلفية الرئيسية للموقع (يفضل صيغة JPG عالية الدقة)</p>
                    <input type="text" id="setMainBg" placeholder="ضع رابط الصورة هنا (JPG)" class="w-full bg-black/40 p-4 rounded-xl border border-white/10 mb-4">
                    <button onclick="updateVisuals()" class="bg-blue-600 px-8 py-3 rounded-xl font-bold">تحديث خلفية الموقع</button>
                </div>

                <div class="glass p-8 rounded-3xl border border-amber-500/30">
                    <h4 class="text-xl font-black mb-4 flex items-center gap-2"><i data-lucide="layout-grid"></i> بوابة إدارة ألبوم الصور</h4>
                    <p class="text-xs text-gray-500 mb-4">أضف روابط صور مرافق المزرعة (رابط واحد في كل سطر)</p>
                    <textarea id="setCatalogImgs" class="w-full bg-black/40 p-4 rounded-xl border border-white/10 h-48 mb-4 font-mono text-xs" placeholder="https://example.com/photo1.jpg"></textarea>
                    <button onclick="updateVisuals()" class="bg-amber-600 px-8 py-3 rounded-xl font-bold text-black">تحديث الألبوم الملكي</button>
                </div>
            </div>

            <div id="tab-archive" class="tab-content hidden">
                <div class="glass rounded-3xl overflow-hidden">
                    <table class="w-full text-right">
                        <thead class="bg-white/5 text-amber-500 text-xs">
                            <tr>
                                <th class="p-4">المستأجر</th>
                                <th class="p-4">النوع</th>
                                <th class="p-4">المبلغ الكلي</th>
                                <th class="p-4">الواصل (50%)</th>
                                <th class="p-4">الإجراء</th>
                            </tr>
                        </thead>
                        <tbody id="adminTableBody" class="text-sm"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Logic & Data Management
        let db = JSON.parse(localStorage.getItem('royal_oasis_db')) || [];
        let config = JSON.parse(localStorage.getItem('royal_oasis_config')) || {
            name: "مزرعة أبو سيف وأبو نمر",
            loc: "أطراف الفلوجة السكنية",
            price: 150000,
            wa: "9647700000000",
            pass: "1234",
            bg: "https://images.unsplash.com/photo-1580587771525-78b9dba3b914?q=80&w=2000&auto=format&fit=crop",
            catalog: [
                "https://images.unsplash.com/photo-1600585154340-be6161a56a0c?q=80&w=1000",
                "https://images.unsplash.com/photo-1584622650111-993a426fbf0a?q=80&w=1000",
                "https://images.unsplash.com/photo-1560749003-d4b1e17818ab?q=80&w=1000"
            ]
        };

        function initApp() {
            lucide.createIcons();
            document.getElementById('farmTitle').innerText = config.name;
            document.getElementById('heroDisplay').innerText = config.name.split(' ').pop().toUpperCase();
            document.getElementById('locationText').innerText = config.loc;
            document.getElementById('dynamicBg').style.backgroundImage = `url(${config.bg})`;
            renderCatalog();
        }

        // Professional Gallery Rendering
        function renderCatalog() {
            const grid = document.getElementById('catalogGrid');
            grid.innerHTML = config.catalog.map((img, i) => `
                <div class="glass p-2 rounded-[2rem] group cursor-pointer overflow-hidden">
                    <div class="h-64 rounded-[1.8rem] overflow-hidden relative">
                        <img src="${img}" class="w-full h-full object-cover group-hover:scale-110 transition duration-700">
                        <div class="absolute top-4 right-4 category-badge">صورة JPG</div>
                    </div>
                </div>
            `).join('');
        }

        // Tab Switching Logic
        function switchTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.add('hidden'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(tabId).classList.remove('hidden');
            event.target.classList.add('active');
            if(tabId === 'tab-stats' || tabId === 'tab-archive') renderAdminData();
        }

        // Admin Panel Functions
        function openAdmin() {
            const p = prompt("رمز الدخول الملكي:");
            if(p === config.pass) {
                document.getElementById('adminPanel').style.display = 'block';
                fillAdminFields();
                renderAdminData();
            } else { alert("عذراً، الرمز غير صحيح"); }
        }

        function closeAdmin() { document.getElementById('adminPanel').style.display = 'none'; }

        function fillAdminFields() {
            document.getElementById('setFarmName').value = config.name;
            document.getElementById('setPrice').value = config.price;
            document.getElementById('setLoc').value = config.loc;
            document.getElementById('setWA').value = config.wa;
            document.getElementById('setMainBg').value = config.bg;
            document.getElementById('setCatalogImgs').value = config.catalog.join('\n');
        }

        function saveAdminSettings() {
            config.name = document.getElementById('setFarmName').value;
            config.price = document.getElementById('setPrice').value;
            config.loc = document.getElementById('setLoc').value;
            config.wa = document.getElementById('setWA').value;
            config.pass = document.getElementById('setPass').value || config.pass;
            localStorage.setItem('royal_oasis_config', JSON.stringify(config));
            alert("تم حفظ الإعدادات بنجاح ✅");
            location.reload();
        }

        function updateVisuals() {
            config.bg = document.getElementById('setMainBg').value;
            config.catalog = document.getElementById('setCatalogImgs').value.split('\n').filter(url => url.trim() !== "");
            localStorage.setItem('royal_oasis_config', JSON.stringify(config));
            alert("تم تحديث الصور بنجاح ✅");
            location.reload();
        }

        function renderAdminData() {
            const tbody = document.getElementById('adminTableBody');
            let totalIncome = 0;
            let totalDebt = 0;
            
            tbody.innerHTML = db.slice().reverse().map(b => {
                totalIncome += (b.total * 0.5);
                totalDebt += (b.total * 0.5);
                return `
                    <tr class="border-b border-white/5">
                        <td class="p-4 font-bold">${b.name}</td>
                        <td class="p-4">${b.type}</td>
                        <td class="p-4">${b.total.toLocaleString()}</td>
                        <td class="p-4 text-green-500">${(b.total * 0.5).toLocaleString()}</td>
                        <td class="p-4"><button class="bg-white/10 px-3 py-1 rounded">عرض</button></td>
                    </tr>
                `;
            }).join('');

            document.getElementById('statIncome').innerText = totalIncome.toLocaleString() + " د.ع";
            document.getElementById('statDebt').innerText = totalDebt.toLocaleString() + " د.ع";
            document.getElementById('statTotal').innerText = (totalIncome + totalDebt).toLocaleString() + " د.ع";
        }
    </script>
</body>
</html>
